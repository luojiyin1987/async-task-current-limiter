function t(t){if("string"!=typeof t&&"symbol"!=typeof t)throw new TypeError(" EVENTNAME expected: string | symbol;but invalid :"+t)}function e(t){if("function"!=typeof t)throw new TypeError(" EVENTLISTENER expected: (event?: any) => void;but invalid:"+t)}const n="EventEmitterTarget";function r(){return{}.toString.call({[Symbol.toStringTag]:n})}function o(o){if(!("number"==typeof o&&o>0&&1/0>o))throw TypeError(" MAX expected: number;but invalid:"+o);const i=o,u=new Map;let s=0,c=0;const f=function o(){const i=function(){const o=new Map,i=new WeakMap;function u(t){let e=o.get(t);return e||(e=new Set,o.set(t,e)),e}function s(e){t(e),o.has(e)&&u(e).clear()}function c(e,n){t(e),o.has(e)&&u(e).forEach(t=>{Promise.resolve().then(()=>{t(n)})})}function f(n,r){t(n),e(r),u(n).add(r)}function l(t,e){u(t).delete(e)}function a(n,r){t(n),e(r),l(n,r),function(t,e){const n=u(t);let r=i.get(e);r&&n.delete(r)}(n,r)}function m(){return[...o].map(([t,e])=>[t,[...e]])[Symbol.iterator]()}return{[Symbol.toPrimitive]:r,[Symbol.toStringTag]:n,[Symbol.iterator]:m,entries:m,listenerCount:function(e){return t(e),o.has(e)?u(e).size:0},clear:s,removeAllListeners:s,on:f,addListener:f,off:a,removeListener:a,once:function(n,r){t(n),e(r);let o=!1,u=i.get(r);if(!u){const t=e=>{l(n,t),l(n,r),o||(o=!0,r(e))};u=t,i.set(r,u)}l(n,r),f(n,u)},emit:c,dispatch:c,eventNames:function(){return[...o.keys()]},listeners:function(e){return t(e),o.has(e)?[...u(e)]:[]}}}();return this&&this instanceof o?(Object.assign(this,i),this):i}(),l=[];let a=!0;function m(){const t=s;if(!a)return;if(t>=l.length)return void(a=!1);if("full"===g())return void(a=!1);!function(){if(!(c<i))throw Error();c++,y()}();const e=l[t];if(!e)throw Error();const[n,r]=e,o=Promise.resolve(Reflect.apply(n,void 0,r)),f=()=>{const e=u.get(t);if(!e)throw new Error;e.resolve(o),function(){if(c-1<0)throw Error();c--,y()}(),l[t]=void 0};o.then(f,f),s++,Promise.resolve().then(()=>{m()})}function h(t){let e=l.length;l.push(t),"free"===g()&&(a=!0,m());const n=function(){let t=t=>{},e=t=>{};return{promise:new Promise((n,r)=>{t=n,e=r}),reject:e,resolve:t}}();return u.set(e,n),Promise.resolve(n.promise)}function g(){return c<i?"free":"full"}f.on("free",()=>{a=!0,m()}),f.on("full",()=>{a=!1});const p={[Symbol.toStringTag]:"AsyncCurrentLimiter",asyncwrap:function(t){return async function(...e){return await h([t,e])}},status:g,limiter:{get max(){return i},get current(){return c}},queue:{get max(){return l.length},get current(){return s}},target:f};function y(){const{queue:t,limiter:e}=p,n={status:g(),queue:{max:t.max,current:t.current},limiter:{max:e.max,current:e.current}};c>=i?f.emit("full",n):f.emit("free",n)}return p}var i=(new Function("return async()=>{}")()(),function t(e){const n=o(e);return this&&this instanceof t?(Object.assign(this,n),this):n});export default i;
//# sourceMappingURL=index.min.js.map
